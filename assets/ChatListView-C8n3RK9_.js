import{j as e,H as y,r as g,g as p}from"./index-m0rfxF2H.js";const A=({characters:i,onSelectChat:x})=>{const l=d=>{let o=null;const r=new Date;return r.setHours(0,0,0,0),d.forEach(m=>{m.anniversaries&&m.anniversaries.length>0&&m.anniversaries.forEach(f=>{const h=new Date(f.date);let v=new Date(r.getFullYear(),h.getMonth(),h.getDate());v<r&&v.setFullYear(r.getFullYear()+1);const u=v.getTime()-r.getTime(),j=Math.ceil(u/(1e3*60*60*24));(o===null||j<o.daysLeft)&&(o={character:m,anniversary:f,daysLeft:j})})}),o},c=g.useMemo(()=>l(i),[i]);if(!c)return null;const{character:s,anniversary:a,daysLeft:n}=c;let t="";return n===0?t="就是今天!":n===1?t="就是明天!":t=`还有 ${n} 天`,e.jsxs("div",{className:"anniversary-banner",onClick:()=>x(s.id),children:[e.jsx("div",{className:"anniversary-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20 6h-2.18c.11-.31.18-.65.18-1a3 3 0 0 0-3-3c-1.35 0-2.5.88-2.87 2.08C11.64 3.4 11.08 3 10.5 3c-.55 0-1.05.37-1.32.87C8.83 3.37 8.16 3 7.5 3A2.5 2.5 0 0 0 5 5.5c0 .35.07.69.18 1H3a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2m-8.5-2a1 1 0 0 1 1 1a1 1 0 0 1-1 1a1 1 0 0 1-1-1a1 1 0 0 1 1-1M6.5 4A1.5 1.5 0 0 1 8 5.5A1.5 1.5 0 0 1 6.5 7A1.5 1.5 0 0 1 5 5.5A1.5 1.5 0 0 1 6.5 4m10 2A1 1 0 0 1 17.5 7a1 1 0 0 1-1-1a1 1 0 0 1 1-1a1 1 0 0 1 1 1M21 20H3V8h18z"})})}),e.jsxs("div",{className:"anniversary-details",children:[e.jsxs("span",{className:"anniversary-name",children:[s.name,"的",a.name]}),e.jsx("span",{className:"anniversary-countdown",children:t})]}),e.jsx("img",{src:s.avatarUrl,alt:s.name,className:"anniversary-avatar"})]})},M=({characters:i,chats:x,onSelectChat:l,onAdd:c})=>{const s=a=>{const n=x[a];if(!n||n.length===0)return"还没有消息。";const t=[...n].reverse().find(d=>d.payload.type!=="text"||d.payload.content.trim());return p(t)};return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"聊天",onAction:c,actionIcon:"add"}),e.jsx(A,{characters:i,onSelectChat:l}),e.jsx("main",{className:"main-content",children:e.jsx("ul",{className:"chat-list",children:i.map(a=>e.jsxs("li",{className:"chat-list-item",onClick:()=>l(a.id),children:[e.jsx("img",{src:a.avatarUrl,alt:a.name,className:"avatar"}),e.jsxs("div",{className:"chat-info",children:[e.jsx("h3",{children:a.name}),e.jsx("p",{children:s(a.id)})]})]},a.id))})})]})};export{M as default};
